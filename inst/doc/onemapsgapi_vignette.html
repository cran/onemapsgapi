<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>OneMapSGAPI R Package</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">OneMapSGAPI R Package</h1>



<p>The OneMapSGAPI package provides useful wrappers for the <a href="https://www.onemap.gov.sg/docs/#introduction">OneMapSG API</a>
client. It allows users to easily query spatial data from the API in a
tidy format and provides additional functionalities to allow easy data
manipulation.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(onemapsgapi)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;dplyr&#39;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:stats&#39;:</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     filter, lag</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:base&#39;:</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span></code></pre></div>
<div id="authentication" class="section level2">
<h2>Authentication</h2>
<p>This function is a wrapper for the <a href="https://www.onemap.gov.sg/docs/#authentication-service-post">Authentication
API endpoint</a> In order to query data, most API endpoints in the
OneMapSG API require a token. First-time users can register themselves
using the <a href="https://developers.onemap.sg/register/">OneMapSG
registration form</a>. Subsequently, they can retrieve their tokens
using the <code>get_token()</code> function with their email and
password, for example:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>token <span class="ot">&lt;-</span> <span class="fu">get_token</span>(<span class="st">&quot;user@example.com&quot;</span>, <span class="st">&quot;password&quot;</span>)</span></code></pre></div>
<pre><code>#&gt; This token will expire on 2022-12-01 09:42:24</code></pre>
<p>The function will also print a message informing users of the token’s
expiry date and time.</p>
</div>
<div id="themes" class="section level2">
<h2>Themes</h2>
<p>These functions are wrappers for the <a href="https://www.onemap.gov.sg/docs/#themes">Themes API</a> endpoints.
Themes in the OneMap SG API refer to types of locations, such as
kindergartens, parks, hawker centres etc.</p>
<div id="check-theme-status" class="section level3">
<h3>Check Theme Status</h3>
<p>The <code>get_theme_status()</code> function allows users to check if
data associated with a theme has been updated after a certain time. It
returns a named logical.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># returns named logical</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_theme_status</span>(token, <span class="st">&quot;kindergartens&quot;</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">get_theme_status</span>(token, <span class="st">&quot;hotels&quot;</span>, <span class="st">&quot;2020-01-01&quot;</span>, <span class="st">&quot;12:00:00&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># returns NULL, warning message shows status code</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_theme_status</span>(<span class="st">&quot;invalid_token&quot;</span>, <span class="st">&quot;blood_bank&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># returns NULL, warning message shows error</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_theme_status</span>(token, <span class="st">&quot;invalid_theme&quot;</span>)</span></code></pre></div>
</div>
<div id="get-theme-information" class="section level3">
<h3>Get Theme Information</h3>
<p>The <code>get_theme_info()</code> function allows users to get
information related to a specific theme. It returns a named character
vector with Theme Name and Query Name.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># returns named character vector</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_theme_status</span>(token, <span class="st">&quot;kindergartens&quot;</span>)</span></code></pre></div>
<p>If an error occurs, the function returns <code>NULL</code>, along
with a warning message.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># returns NULL, warning message shows status code</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_theme_status</span>(<span class="st">&quot;invalid_token&quot;</span>, <span class="st">&quot;blood_bank&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># returns NULL, warning message shows error</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_theme_status</span>(token, <span class="st">&quot;invalid_theme&quot;</span>)</span></code></pre></div>
</div>
<div id="find-themes-of-interest" class="section level3">
<h3>Find Themes of Interest</h3>
<p>The <code>search_themes()</code> function allows users to find
details of themes of interest. It returns a tibble of themes matching
user’s search terms. Alternatively, if no search terms are added, a
tibble of all themes available through the API is returned. The variable
<strong>THEMENAME</strong> in the output tibble serves as the input for
getting theme data.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># return all themes related to &quot;hdb&quot; or &quot;parks&quot;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">search_themes</span>(token, <span class="st">&quot;hdb&quot;</span>, <span class="st">&quot;parks&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># return all possible themes</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">search_themes</span>(token)</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># return all possible themes, with less variables</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">search_themes</span>(token, <span class="at">more_info =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>If an error occurs, the function returns <code>NULL</code>, along
with a warning message.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">search_themes</span>(<span class="st">&quot;my_invalid_token&quot;</span>)</span></code></pre></div>
</div>
<div id="get-theme-data" class="section level3">
<h3>Get Theme Data</h3>
<p>The function <code>get_theme()</code> returns data related to a
particular theme, often location coordinates and other information. It
returns the output as a tibble, or prints a warning message when an
error is encountered. All tibbles will contain the variables:
<strong>NAME</strong>, <strong>DESCRIPTION</strong>,
<strong>ADDRESSPOSTALCODE</strong>, <strong>ADDRESSSTREETNAME</strong>,
<strong>Lat</strong>, <strong>Lng</strong>, <strong>ICON_NAME</strong>,
and some provide additional information; for example, query hawker
centres gives additional information about the completion date of each
hawker centre. Option to return a spatial dataframe available.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># return all hotel data</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_theme</span>(token, <span class="st">&quot;hotels&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># return all monuments data within a bounding area</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_theme</span>(token, <span class="st">&quot;monuments&quot;</span>, <span class="at">extents =</span> <span class="st">&quot;1.291789,%20103.7796402,1.3290461,%20103.8726032&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># return all monuments data as a sf dataframe</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_theme</span>(token, <span class="st">&quot;monuments&quot;</span>, <span class="at">read =</span> <span class="st">&quot;sf&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># returns a list of status tibble and output tibble</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_theme</span>(token, <span class="st">&quot;funeralparlours&quot;</span>, <span class="at">return_info =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str</span>()</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># error: output is NULL, warning message shows status code</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_theme</span>(<span class="st">&quot;invalid_token&quot;</span>, <span class="st">&quot;hotels&quot;</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># error: output is NULL, warning message shows error message from request</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">get_theme</span>(token, <span class="st">&quot;non-existent-theme&quot;</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># error: output is query_info, warning message query did not return any records</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="fu">get_theme</span>(token, <span class="st">&quot;ura_parking_lot&quot;</span>, <span class="st">&quot;1.291789,%20103.7796402,1.3290461,%20103.8726032&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="planning-areas" class="section level2">
<h2>Planning Areas</h2>
<p>These functions are a wrapper for the <a href="https://www.onemap.gov.sg/docs/#planning-area">Planning Area
API</a>. Planning Area API endpoints allow users to get spatial data and
data related to the planning areas in Singapore. This package provides
users with the ability to query the data and optionally handles
necessary spatial data wrangling on behalf of the user.</p>
<div id="get-planning-areas" class="section level3">
<h3>Get Planning Areas</h3>
<p>The function <code>get_planning_areas()</code> allows users to query
all the spatial polygons associated with Singapore’s planning areas, for
certain years. The function also optionally helps users transform raw
geojson strings into <code>sf</code> or <code>sp</code> objects.</p>
<p>If the parameter read is not specified, the function returns a raw
JSON object with planning names and geojson string vectors.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># returns raw JSON object</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_planning_areas</span>(token)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">get_planning_areas</span>(token, <span class="dv">2008</span>)</span></code></pre></div>
<p>If read is specified, any missing geojson objects will be dropped
(this affects the “Others” planning area returned by the API). The
returned outputs are NOT projected.</p>
<p>If read = “sf”, the function returns a single “sf” dataframe with 2
columns: “name” (name of planning area) and “geometry”, which contains
the simple features.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># returns dataframe of class &quot;sf&quot;</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_planning_areas</span>(token, <span class="at">read =</span> <span class="st">&quot;sf&quot;</span>)</span></code></pre></div>
<p>If read = “rgdal”, the function returns a SpatialPolygonsDataFrame of
“sp” class with 2 columns: “name” (name of planning area) and
“geometry”.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># returns SpatialPolygonsDataFrame (&quot;sp&quot; object)</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_planning_areas</span>(token, <span class="at">read =</span> <span class="st">&quot;rgdal&quot;</span>)</span></code></pre></div>
<p>Note that if the user specifies a read method but does not have the
corresponding package installed, the function will return the raw JSON
and print a warning message.</p>
<p>If an error occurs, the function returns NULL and a warning message
is printed.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># error: output is NULL, warning message shows status code</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_planning_areas</span>(<span class="st">&quot;invalid_token&quot;</span>)</span></code></pre></div>
</div>
<div id="get-planning-area-names" class="section level3">
<h3>Get Planning Area Names</h3>
<p>The function <code>get_planning_names()</code> allows users to query
all planning area names for certain years. The function returns a tibble
with planning area code and planning area name.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># returns tibble</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_planning_names</span>(token)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">get_planning_names</span>(token, <span class="dv">2008</span>)</span></code></pre></div>
<p>If an error occurs, the function returns NULL and a warning message
is printed.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># error: output is NULL, warning message shows status code</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_planning_names</span>(<span class="st">&quot;invalid_token&quot;</span>)</span></code></pre></div>
</div>
<div id="get-planning-area-polygon" class="section level3">
<h3>Get Planning Area Polygon</h3>
<p>The function <code>get_planning_polygon()</code> allows users to
query a particular planning area polygon containing the specified
location point. The function also optionally helps users transform raw
geojson string output into <code>sf</code> or <code>sp</code>
objects.</p>
<p>If the parameter read is not specified, the function returns a raw
JSON object a list containing the planning area name and a geojson
string representing the polygon.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># returns raw JSON object</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_planning_polygon</span>(token, <span class="at">lat =</span> <span class="fl">1.429443081</span>, <span class="at">lon =</span> <span class="fl">103.835005</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">get_planning_polygon</span>(token, <span class="at">lat =</span> <span class="fl">1.429443081</span>, <span class="at">lon =</span> <span class="fl">103.835005</span>, <span class="at">year =</span> <span class="dv">2008</span>)</span></code></pre></div>
<p>If read = “sf”, the function returns a 1 x 2 “sf” dataframe: “name”
(name of planning area) and “geometry”, which contains the simple
feature.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># returns dataframe of class &quot;sf&quot;</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_planning_polygon</span>(token, <span class="at">lat =</span> <span class="fl">1.429443081</span>, <span class="at">lon =</span> <span class="fl">103.835005</span>, <span class="at">read =</span> <span class="st">&quot;sf&quot;</span>)</span></code></pre></div>
<p>If read = “rgdal”, the function returns a SpatialPolygonsDataFrame of
“sp” class. The names of the planning area is recorded in the “name”
column of the dataframe. If an error occurs, the function returns NULL
and a warning message is printed.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># returns SpatialPolygonsDataFrame (&quot;sp&quot; object)</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_planning_polygon</span>(token, <span class="at">lat =</span> <span class="fl">1.429443081</span>, <span class="at">lon =</span> <span class="fl">103.835005</span>, <span class="at">read =</span> <span class="st">&quot;rgdal&quot;</span>)</span></code></pre></div>
<p>Note that if the user specifies a read method but does not have the
corresponding package installed, the function will return the raw JSON
and print a warning message.</p>
<p>If an error occurs, the function returns NULL and a warning message
is printed.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># error &amp; will not run: missing lat and lon arguments</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_planning_polygon</span>(<span class="st">&quot;invalid_token&quot;</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># error: output is NULL, warning message shows status code</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fu">get_planning_polygon</span>(token, <span class="st">&quot;invalidlat&quot;</span>, <span class="st">&quot;invalidlon&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="population-query" class="section level2">
<h2>Population Query</h2>
<p>These functions are a wrapper for the <a href="https://www.onemap.gov.sg/docs/#population-query">Population Query
API</a>. Population Query API endpoints allow users to pull
socio-economic datasets by planning area, which each endpoint
representing a dataset (e.g. <code>getPopulationAgeGroup</code> provides
age group summary statistics by planning area). This package combines
querying different Popquery API endpoints into single functions.</p>
<div id="multiple-queries" class="section level3">
<h3>Multiple Queries</h3>
<p>The function <code>get_pop_queries()</code> allows users to query
multiple datasets for multiple towns, years and genders.</p>
<p>The <code>gender</code> parameter is only valid for the
<strong>getEconomicStatus</strong>, <strong>getEthnicGroup</strong>,
<strong>getMaritalStatus</strong> and
<strong>getPopulationAgeGroup</strong> endpoints. If specified for other
endpoints, the parameter will be dropped.</p>
<p>If gender is not specified for endpoints which accept a gender
parameter, records for total, male and female will be returned.</p>
<p>The function returns a tibble with each row representing a town in a
particular year for a particular gender, and columns representing the
variables returned by the API endpoint. If any API call returns no data,
the values will be NA but the row will be returned. However, if all
data_types do not return data for that town and year, no row will be
returned for it.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># example: returns output with no NA</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_pop_queries</span>(token, <span class="fu">c</span>(<span class="st">&quot;getOccupation&quot;</span>, <span class="st">&quot;getLanguageLiterate&quot;</span>), </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">c</span>(<span class="st">&quot;Bedok&quot;</span>, <span class="st">&quot;Yishun&quot;</span>), <span class="st">&quot;2010&quot;</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># example: returns output with no NA and gender field</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">get_pop_queries</span>(token, <span class="fu">c</span>(<span class="st">&quot;getEconomicStatus&quot;</span>, <span class="st">&quot;getEthnicGroup&quot;</span>), </span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;Yishun&quot;</span>, <span class="st">&quot;2010&quot;</span>, <span class="st">&quot;female&quot;</span>)</span></code></pre></div>
<p>If the data types request contains a mix of those that accept gender
parameters and those that do not, only <code>gender = &quot;Total&quot;</code>
rows will display all records. The data types that do not accept gender
params will return results under <code>gender = Total</code>.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># example: gender not specified</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_pop_queries</span>(token, <span class="fu">c</span>(<span class="st">&quot;getEconomicStatus&quot;</span>, <span class="st">&quot;getOccupation&quot;</span>, <span class="st">&quot;getLanguageLiterate&quot;</span>),</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;Bedok&quot;</span>, <span class="st">&quot;2010&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># example: gender specified</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_pop_queries</span>(token, <span class="fu">c</span>(<span class="st">&quot;getEconomicStatus&quot;</span>, <span class="st">&quot;getOccupation&quot;</span>, <span class="st">&quot;getLanguageLiterate&quot;</span>),</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;Bedok&quot;</span>, <span class="st">&quot;2010&quot;</span>, <span class="at">gender =</span> <span class="st">&quot;female&quot;</span>)</span></code></pre></div>
<p>If all data_types do not return data for that town and year, no row
will be returned. A warning message will show data_type/town/year/gender
for which an error occurred.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># example: no records for 2012</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_pop_queries</span>(token, <span class="fu">c</span>(<span class="st">&quot;getEconomicStatus&quot;</span>, <span class="st">&quot;getOccupation&quot;</span>),</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;Bedok&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;2010&quot;</span>, <span class="st">&quot;2012&quot;</span>))</span></code></pre></div>
<p>Finally, to allow for faster computation, API calls can be called in
parallel using <code>parallel = TRUE</code>. This is recommended for
large requests.</p>
</div>
</div>
<div id="route-service" class="section level2">
<h2>Route Service</h2>
<p>These functions are a wrapper for the <a href="https://www.onemap.gov.sg/docs/#routing-service">Route Service
API</a>. The Route Service API provides users a way to query the route
taken from one point to another. It provides information about the total
time and distance taken for the route, route instructions and other
infomation e.g. elevation, for a variety of routes (public transport,
drive, walk, cycle). This package provides three different functions
associated with this API, each serving different purposes.</p>
<div id="all-route-information" class="section level3">
<h3>All Route Information</h3>
<p>The <code>get_route()</code> function returns all API output but with
standardized column names, which allows for subsequent merging if
desired. This is particularly useful as API output variable names may
vary depending on parameters (e.g. start point is named differently
between <code>route = drive</code> and <code>route = pt</code>).</p>
<p>It returns the full route data in a tibble format, or a list
containing a tibble of results and list of status information if
desired.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># example: only route data, route = drive</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_route</span>(token, <span class="fu">c</span>(<span class="fl">1.319728</span>, <span class="fl">103.8421</span>), <span class="fu">c</span>(<span class="fl">1.319728905</span>, <span class="fl">103.8421581</span>), <span class="st">&quot;drive&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># example: only route data, route = pt</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_route</span>(token, <span class="fu">c</span>(<span class="fl">1.319728</span>, <span class="fl">103.8421</span>), <span class="fu">c</span>(<span class="fl">1.319728905</span>, <span class="fl">103.8421581</span>), <span class="st">&quot;pt&quot;</span>,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">mode =</span> <span class="st">&quot;bus&quot;</span>, <span class="at">max_dist =</span> <span class="dv">300</span>)</span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># example: returns list of status list and output tibble</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_route</span>(token, <span class="fu">c</span>(<span class="fl">1.319728</span>, <span class="fl">103.8421</span>), <span class="fu">c</span>(<span class="fl">1.319728905</span>, <span class="fl">103.8421581</span>), </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;drive&quot;</span>, <span class="at">status_info =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str</span>()</span></code></pre></div>
<p>By default, the API returns route geometry in an encoded format. To
return results in a decoded <code>sf</code> format, set the parameter
<code>decode = TRUE</code>.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># example: returns sf dataframe with decoded route geometry</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_route</span>(token, <span class="fu">c</span>(<span class="fl">1.319728</span>, <span class="fl">103.8421</span>), <span class="fu">c</span>(<span class="fl">1.319728905</span>, <span class="fl">103.8421581</span>), <span class="st">&quot;drive&quot;</span>, <span class="at">decode =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">get_route</span>(token, <span class="fu">c</span>(<span class="fl">1.319728</span>, <span class="fl">103.8421</span>), <span class="fu">c</span>(<span class="fl">1.319728905</span>, <span class="fl">103.8421581</span>), <span class="st">&quot;pt&quot;</span>, <span class="at">mode =</span> <span class="st">&quot;bus&quot;</span>, <span class="at">max_dist =</span> <span class="dv">300</span>, <span class="at">n_itineraries =</span> <span class="dv">2</span>, <span class="at">decode =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># example: error, warning message shows status code</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_route</span>(<span class="st">&quot;invalid_token&quot;</span>, <span class="fu">c</span>(<span class="fl">1.319728</span>, <span class="fl">103.8421</span>), <span class="fu">c</span>(<span class="fl">1.319728905</span>, <span class="fl">103.8421581</span>), <span class="st">&quot;drive&quot;</span>)</span></code></pre></div>
</div>
<div id="total-time-and-distance-matrix" class="section level3">
<h3>Total time and distance matrix</h3>
<p>The function <code>get_travel()</code> allows the calculation of
total travel time and distance for a tibble of start and end points.
Users input a tibble of start and end points (and potentially other
variables) and the function returns the tibble with additional columns,
<code>total_time</code> and <code>total_dist</code>. Recognising that
this API is most valuable for calculating total time travelled (as a
improved measure of spatial distance compared to Euclidean distance),
this function produces a cleaner output containing only the main
variables of interest.</p>
<p>The function also accepts multiple arguments for <code>route</code>
and <code>pt_mode</code>, allowing users to compare various route
options.</p>
<p>Note that if <code>as_wide = TRUE</code> is selected, any columns
with identical names as the additional output columns will be
overwritten.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># example: create sample df with start and end coordinates</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>sample <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">start_lat =</span> <span class="fu">c</span>(<span class="fl">1.3746617</span>, <span class="fl">1.3567797</span>, <span class="fl">1.3361976</span>, <span class="dv">500</span>),</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">start_lon =</span> <span class="fu">c</span>(<span class="fl">103.8366159</span>, <span class="fl">103.9347695</span>, <span class="fl">103.6957732</span>, <span class="dv">501</span>),</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">end_lat =</span> <span class="fu">c</span>(<span class="fl">1.429443081</span>, <span class="fl">1.380298287</span>, <span class="fl">1.337586882</span>, <span class="dv">601</span>),</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">end_lon =</span> <span class="fu">c</span>(<span class="fl">103.835005</span>, <span class="fl">103.7452918</span>, <span class="fl">103.6973215</span>, <span class="dv">600</span>),</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">add_info =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># example: multiple routes</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_travel</span>(token, sample[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, ],</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;start_lat&quot;</span>, <span class="st">&quot;start_lon&quot;</span>, <span class="st">&quot;end_lat&quot;</span>, <span class="st">&quot;end_lon&quot;</span>,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">routes =</span> <span class="fu">c</span>(<span class="st">&quot;cycle&quot;</span>, <span class="st">&quot;walk&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># example: multiple routes + multiple pt modes </span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_travel</span>(token, sample[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, ],</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;start_lat&quot;</span>, <span class="st">&quot;start_lon&quot;</span>, <span class="st">&quot;end_lat&quot;</span>, <span class="st">&quot;end_lon&quot;</span>,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">routes =</span> <span class="fu">c</span>(<span class="st">&quot;drive&quot;</span>, <span class="st">&quot;pt&quot;</span>), <span class="at">pt_mode =</span> <span class="fu">c</span>(<span class="st">&quot;bus&quot;</span>, <span class="st">&quot;transit&quot;</span>))</span></code></pre></div>
<p>By default, the data appears in a wide format, but users can specify
for the output to be in long format.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># example: long format</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_travel</span>(token, sample[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, ],</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;start_lat&quot;</span>, <span class="st">&quot;start_lon&quot;</span>, <span class="st">&quot;end_lat&quot;</span>, <span class="st">&quot;end_lon&quot;</span>,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">routes =</span> <span class="fu">c</span>(<span class="st">&quot;walk&quot;</span>, <span class="st">&quot;pt&quot;</span>), <span class="at">pt_mode =</span> <span class="fu">c</span>(<span class="st">&quot;bus&quot;</span>, <span class="st">&quot;transit&quot;</span>),</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">as_wide =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>There is also the option to return a sf dataframe in long format by
specifying <code>route_geom = TRUE</code>. This allows, for example,
mapping of different route options.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_travel</span>(token, sample[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, ],</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;start_lat&quot;</span>, <span class="st">&quot;start_lon&quot;</span>, <span class="st">&quot;end_lat&quot;</span>, <span class="st">&quot;end_lon&quot;</span>,</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">routes =</span> <span class="fu">c</span>(<span class="st">&quot;drive&quot;</span>, <span class="st">&quot;pt&quot;</span>), <span class="at">pt_mode =</span> <span class="fu">c</span>(<span class="st">&quot;bus&quot;</span>, <span class="st">&quot;transit&quot;</span>), </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">as_wide =</span> <span class="cn">FALSE</span>, <span class="at">route_geom =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>If an error occurs, the output row will be have NAs for the
additional variables, along with a warning message. The warning message
will show start/end/route/pt_mode for which an error occurred.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># example: with error</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_travel</span>(token, sample,</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;start_lat&quot;</span>, <span class="st">&quot;start_lon&quot;</span>, <span class="st">&quot;end_lat&quot;</span>, <span class="st">&quot;end_lon&quot;</span>,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">routes =</span> <span class="fu">c</span>(<span class="st">&quot;cycle&quot;</span>, <span class="st">&quot;walk&quot;</span>))</span></code></pre></div>
<p>Lastly, it recommended for users working with large matrices to set
<code>parallel = TRUE</code> for more efficient computation.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
